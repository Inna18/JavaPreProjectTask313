<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor"
          crossorigin="anonymous">
    <title>Admin panel</title>
</head>
<body>

<!--Top Nav-->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
                <span class="navbar-text">
                    <span th:text="${#authentication.getPrincipal().getUsername()}"></span>
                    <span> with roles: </span>
                    <th:block th:each="role : ${#authentication.authorities}">
    &nbsp;               <span th:text="${role.getName()}"/>
                    </th:block>
                </span>
        <span class="navbar-nav">
                    <a class="nav-link" href="/logout">Logout</a>
                </span>
    </div>
</nav>

<!--Admin User Nav-->
<div class="d-flex align-items-start" style="width: 100%;">
    <div class="nav flex-column nav-pills mt-3" id="v-pills-tab" role="tablist" aria-orientation="vertical">
        <button class="nav-link active text-start" id="v-pills-admin-tab" data-bs-toggle="pill" data-bs-target="#v-pills-admin"
                type="button" role="tab" aria-controls="v-pills-admin" aria-selected="true" style="width: 10rem;">Admin
        </button>
        <button class="nav-link text-start" id="v-pills-user-tab" data-bs-toggle="pill" data-bs-target="#v-pills-user"
                type="button" role="tab" aria-controls="v-pills-user" aria-selected="false" style="width: 10rem;">User
        </button>
    </div>
    <div class="tab-content flex-fill" id="v-pills-tabContent">

        <!--Admin-->
        <div class="tab-pane show active" id="v-pills-admin" role="tabpanel" aria-labelledby="v-pills-admin-tab">
            <div class="container-fluid bg-light p-3 vh-100">
                <div class="row">
                    <div class="col">
                        <div class="container-fluid">
                            <h3>Admin panel</h3>

                            <!-- Tabs -->
                            <ul class="nav nav-tabs">
                                <li class="nav-item">
                                    <a class="nav-link active" href="#usersTable" data-bs-toggle="tab">Users Table</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#addNewUser" data-bs-toggle="tab">New User</a>
                                </li>
                            </ul>

                            <!-- Tabs content -->
                            <div class="tab-content">

                                <!-- User Table Tab-->
                                <div class="tab-pane show active" id="usersTable">
                                    <div class="card">
                                        <div class="card-header">
                                            All users
                                        </div>
                                        <ul class="list-group list-group-flush">
                                            <li class="list-group-item">
                                                <table class="table table-hover mt-1">
                                                    <thead class="table-light">
                                                    <tr>
                                                        <th class="text-center">ID</th>
                                                        <th class="text-center">Name</th>
                                                        <th class="text-center">Surname</th>
                                                        <th class="text-center">Age</th>
                                                        <th class="text-center">Email</th>
                                                        <th class="text-center">Roles</th>
                                                        <th class="text-center">Operations</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    <tr th:each="user : ${allUsers}">
                                                        <td class="text-center" th:text="${user.id}"></td>
                                                        <td class="text-center" th:text="${user.name}"></td>
                                                        <td class="text-center" th:text="${user.surname}"></td>
                                                        <td class="text-center" th:text="${user.age}"></td>
                                                        <td class="text-center" th:text="${user.email}"></td>
                                                        <td class="text-center">
                                                            <span th:each="role : ${user.roles}"
                                                                  th:text="${role.name}+' '">
                                                            </span>
                                                        </td>
                                                        <td class="text-center">
                                                            <a th:href="@{/admin/updateUser/{id}(id=${user.id})}">
                                                            <button type="button" class="btn btn-primary btn-sm mr-1" >
                                                                Update
                                                            </button>
                                                            </a>
                                                            <a th:href="@{/admin/deleteUser/{id}(id=${user.id})}">
                                                                <button type="button" class="btn btn-danger btn-sm">
                                                                    Delete
                                                                </button>
                                                            </a>
                                                        </td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </li>
                                        </ul>
                                    </div>
                                </div>

                                <!-- Add User Tab-->
                                <div class="tab-pane" id="addNewUser">
                                    <div class="card">
                                        <div class="card-header">
                                            Add new user
                                        </div>
                                        <div class="card-body">
                                            Add New User Form
<!--                                            <form role="form" id="addNewUserForm" th:action="@{/admin/saveUser}" th:object="${user}" th:method="POST">-->

<!--                                                <div class="form-group mb-3">-->
<!--                                                    <label for="newName">Name</label>-->
<!--                                                    <input type="text" th:field="*{name}" placeholder="Name" class="form-control" id="newName"/>-->
<!--                                                </div>-->
<!--                                                <div class="form-group mb-3">-->
<!--                                                    <label for="newSurname">Surname</label>-->
<!--                                                    <input type="text" th:field="*{surname}" placeholder="Surname" class="form-control" id="newSurname"/>-->
<!--                                                </div>-->
<!--                                                <div class="form-group mb-3">-->
<!--                                                    <label for="newAge">Age</label>-->
<!--                                                    <input type="text" th:field="*{age}" placeholder="Age" class="form-control" id="newAge"/>-->

<!--                                                </div>-->
<!--                                                <div class="form-group mb-3">-->
<!--                                                    <label for="newEmail">Email</label>-->
<!--                                                    <input type="text" th:field="*{email}" placeholder="Email" class="form-control" id="newEmail"/>-->
<!--                                                </div>-->
<!--                                                <div class="form-group mb-3">-->
<!--                                                    <label for="newPassword">Password</label>-->
<!--                                                    <input type="text" th:field="*{password}" placeholder="Password" class="form-control" id="newPassword"/>-->
<!--                                                </div>-->
<!--                                                <div class="form-group mb-3">-->
<!--                                                    <label for="newRoles">Roles</label>-->
<!--                                                    <select multiple class="form-control" id="newRoles" name="roles">-->
<!--                                                        <option th:each="role : ${roles}"-->
<!--                                                                th:selected="*{hasRole('__${role.id}__')}" th:text="${role.name}"-->
<!--                                                                th:value="${role.id}">-->
<!--                                                    </select>-->
<!--                                                </div>-->

<!--                                                <div class="box-footer">-->
<!--                                                    <input type="submit" class="btn btn-success" value="Add" />-->
<!--                                                </div>-->

<!--                                            </form>-->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <br/>
                        <input type="button" value="Add" onclick="window.location.href='/admin/addNewUser'"/>

                    </div>
                </div>
            </div>
        </div>

        <!--User-->
        <div class="tab-pane" id="v-pills-user" role="tabpanel" aria-labelledby="v-pills-user-tab">
            <div class="container-fluid bg-light p-3 vh-100">
                <div class="row">
                    <div class="col">
                        <div class="container-fluid">
                            <h3>User information-page</h3>

                            <div class="card">
                                <div class="card-header">
                                    About user
                                </div>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item">
                                        <table class="table table-hover mt-1">
                                            <thead class="table-light">
                                            <tr>
                                                <th class="text-center">ID</th>
                                                <th class="text-center">Name</th>
                                                <th class="text-center">Surname</th>
                                                <th class="text-center">Age</th>
                                                <th class="text-center">Email</th>
                                                <th class="text-center">Roles</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr>
                                                <td class="text-center" sec:authentication="principal.id"></td>
                                                <td class="text-center" sec:authentication="principal.name"></td>
                                                <td class="text-center" sec:authentication="principal.surname"></td>
                                                <td class="text-center" sec:authentication="principal.age"></td>
                                                <td class="text-center" sec:authentication="principal.email"></td>
                                                <td class="text-center">
                                                    <th:block th:each="role : ${#authentication.authorities}">
                                                        <span th:text="${role.getName()}"/>
                                                    </th:block>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!--Update Modal-->
<!--<div class="myForm">-->
<!--    <div class="modal" id="updateModal">-->
<!--        <form th:action="@{/admin/saveUser}" th:object="${user}" method="POST">-->
<!--            <div class="modal-dialog">-->
<!--                <div class="modal-content">-->
<!--                    <div class="modal-header">-->
<!--                        <h5 class="modal-title">Update user</h5>-->
<!--                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>-->
<!--                    </div>-->
<!--                    <div class="modal-body">-->
<!--                        <input type="hidden" th:field="*{id}">-->

<!--                        <div class="form-group">-->
<!--                            <label for="updateID">ID</label>-->
<!--                            <input type="text" class="form-control" id="updateID" placeholder="ID" th:field="*{id}">-->
<!--                        </div>-->
<!--                        <div class="form-group">-->
<!--                            <label for="updateName">Name</label>-->
<!--                            <input type="text" class="form-control" id="updateName" placeholder="Name" th:field="*{name}">-->
<!--                            <p style="color:red" th:if="${#fields.hasErrors('name')}" th:errors="*{name}">Name error</p>-->
<!--                        </div>-->
<!--                        <div class="form-group">-->
<!--                            <label for="updateSurname">Surname</label>-->
<!--                            <input type="text" class="form-control" id="updateSurname" placeholder="Surname" th:field="*{surname}">-->
<!--                            <p style="color:red" th:if="${#fields.hasErrors('surname')}" th:errors="*{surname}">Surname error</p>-->
<!--                        </div>-->
<!--                        <div class="form-group">-->
<!--                            <label for="updateAge">Age</label>-->
<!--                            <input type="text" class="form-control" id="updateAge" placeholder="Age" th:field="*{age}">-->
<!--                            <p style="color:red" th:if="${#fields.hasErrors('age')}" th:errors="*{age}">Age error</p>-->
<!--                        </div>-->
<!--                        <div class="form-group">-->
<!--                            <label for="updateEmail">Email</label>-->
<!--                            <input type="text" class="form-control" id="updateEmail" placeholder="Email" th:field="*{email}">-->
<!--                            <p style="color:red" th:if="${#fields.hasErrors('email')}" th:errors="*{email}">Email error</p>-->
<!--                        </div>-->
<!--                        <div class="form-group">-->
<!--                            <label for="updatePassword">Password</label>-->
<!--                            <input type="text" class="form-control" id="updatePassword" placeholder="Password" th:field="*{password}">-->
<!--                            <p style="color:red" th:if="${#fields.hasErrors('password')}" th:errors="*{password}">Password error</p>-->
<!--                        </div>-->
<!--                        <div class="form-group">-->
<!--                            <label for="updateRoles">Roles</label>-->
<!--                            <input type="text" class="form-control" id="updateRoles" placeholder="Roles" th:field="*{id}">-->
<!--                            <p style="color:red" th:if="${#fields.hasErrors('roles')}" th:errors="*{roles}">Roles error</p>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    <div class="modal-footer">-->
<!--                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>-->
<!--                        <button type="submit" class="btn btn-primary">Update</button>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--        </form>-->
<!--    </div>-->
<!--</div>-->

<!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
        crossorigin="anonymous"></script>

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

</body>
</html>